import{initializeApp}from"https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";import{onSnapshot,collection,doc,setDoc,getDocs,getFirestore,updateDoc,increment}from"https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";const firebaseConfig={apiKey:"AIzaSyAh9_foQiyNYjMAyvhjDqglCALeIEEM8Yk",authDomain:"votos-11d12.firebaseapp.com",projectId:"votos-11d12",storageBucket:"votos-11d12.appspot.com",messagingSenderId:"749944122292",appId:"1:749944122292:web:856682d456e713a0f760e1",measurementId:"G-JQZGDCK8QJ"},app=initializeApp(firebaseConfig),db=getFirestore(),candidatosCollection=collection(db,"candidatos");function crearCardCandidato(o){var e=document.createElement("div");e.classList.add("card");var t=document.createElement("div"),a=(t.classList.add("card-body"),document.createElement("h5")),d=(a.classList.add("card-title"),a.textContent=o.nombre,document.createElement("p")),s=(d.classList.add("card-text"),d.textContent=o.informacion,document.createElement("p")),c=(s.classList.add("card-text","card-text-votos"),s.textContent="Votos: "+o.votos,document.createElement("img")),i=(c.classList.add("card-img-top","custom-img-size"),console.log("Valor de candidato.img:",o.img),o.img.includes("lamerce")?c.src="https://firebasestorage.googleapis.com/v0/b/votos-11d12.appspot.com/o/lamerce.jpg?alt=media&token=8ae5d097-25bf-4cd2-8e55-fc42376511f1":!o.img.includes("danielo")&&o.img.includes("elflexita")?c.src="https://firebasestorage.googleapis.com/v0/b/votos-11d12.appspot.com/o/elflexita.jpg?alt=media&token=bf325cb2-0dbc-47c4-b2fc-90a57376aa5f":c.src="https://firebasestorage.googleapis.com/v0/b/votos-11d12.appspot.com/o/danielo.jpg?alt=media&token=0ce73180-53e9-4b38-bc79-c70b47e4360f",document.createElement("button"));i.classList.add("btn","btn-primary"),i.textContent="Votar";const n=document.createElement("span");n.classList.add("contador-votos"),n.textContent="Votos: "+o.votos,t.appendChild(a),t.appendChild(d),t.appendChild(c),t.appendChild(s),t.appendChild(i),t.appendChild(n),e.appendChild(t),document.getElementById("candidatosContainer").appendChild(e),i.addEventListener("click",async()=>{var e,t,a=fetch("https://api.ipify.org/?format=json").then(e=>e.json()).then(e=>e.ip).catch(e=>(console.log("Error al obtener la direcciÃ³n IP:",e),null));localStorage.getItem(a)?alert("Ya has votado antes"):(e=o.votos+1,t=doc(db,"candidatos",o.id),await updateDoc(t,{votos:increment(1)}),localStorage.setItem(a,!0),n.textContent="Votos: "+e)})}async function obtenerCandidatos(){(await getDocs(candidatosCollection)).forEach(e=>{var t=e.data();t.id=e.id,crearCardCandidato(t)})}obtenerCandidatos();